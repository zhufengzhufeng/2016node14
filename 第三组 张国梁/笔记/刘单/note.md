##指令 - 指令是不依赖控制器的 - 指令默认不会产生作用域，也可以声明创建作用域 - 指令的分类：1）装饰行：主要负责添加功能；2）组件式：替换成一个完整的组件，可以复用 - 指令的格式：命名规则 html中单词以'-' 链接，js中采用驼峰命名                 var app=angular.module('appModule',[]);         app.directive('myDrag',function(){//指令返回对象          return {             restrict:'ECMA',//限制使用范围，每一个字母代表一种格式             replace:true,//替换外层的原有的标签，要求模板必须有一个根节点             template：`<div><h1>HELLO ANGULAR</h1> <p>哈哈</p></div>`//只要涉及到模板替换，外面就要有一个根节点          }        })                restrict：ECMA           <!--Attribute A-->           <div my-drag></div>           <!--Element E-->           <my-drag></my-drag>           <!--Class C-->           <div class="my-drag"></div>           <!--Comment M-->           <!-- directive:drag -->                      ##装饰型指令      app.directive('colorRed',function () {          return {              restrict:'A',              //操作dom              link:function (scope,element,attrs) {//链接 连接作用域和视图 形参scope                  //scope 代表当前指令所在的作用域，指令没有创建作用域，使用的是上一级                  //element 代表当前指令所在的元素                  //attrs 代表指令上的所有属性                  element.css({'color':'purple','font-size':'100px'});//angular 里必须添加px              }          }      })       装饰型指令--拖拽            <!DOCTYPE html>      <html lang="en" ng-app="appModule">      <head>          <meta charset="UTF-8">          <title>珠峰培训http://www.zhufengpeixun.cn</title>          <style>              div{background: red;width: 150px;height: 150px;position: absolute}              div+div{background: yellow}              div+div+div{background: blue}              div+div+div+div{background: pink}          </style>      </head>      <body>      <div drag>hello</div>      <div drag>hello</div>      <div drag>hello</div>      <div drag>hello</div>      <!--先引用jq  angular才不会加载自己的jquery-->      <script src="node_modules/jquery/dist/jquery.js"></script>      <script src="node_modules/angular/angular.js"></script>      <script>          var app = angular.module('appModule',[]);          app.directive('drag',function () {              return {                  restrict:'A',                  link:function (scope,element,attr) {                      element.on('mousedown',function (e) {                          //当前鼠标距离浏览器的距离-元素到浏览器的距离 = 鼠标距离元素边缘的距离                          var disX = e.pageX - $(this).offset().left;                          var disY = e.pageY - $(this).offset().top;                          $(document).on('mousemove',function (e) {                              //鼠标距离浏览器的距离 - 鼠标距离元素边缘的距离 = 元素到浏览器的距离                              element.css({                                  top:(e.pageY - disY),                                  left:(e.pageX - disX),                              });                          });                          $(document).on('mouseup',function () {                              $(document).off(); //第一次执行后 移除所有document事件                          });                          e.preventDefault();//防止默认事件触发                      });                      /*element.on('click',function () {                       angular.element(this) == $(this)                       console.log(angular.element(this));                       })*/                  }              }          });      //    app.directive('drag',function () {      //        return {      //            restrict:'A',      //            link:function (scope,element,attr) {      //                element.on('mousedown',function (e) {      //                    //当前鼠标距离浏览器的距离-元素到浏览器的距离 = 鼠标距离元素边缘的距离      //                    var disX = e.pageX - this.offsetLeft;      //                    var disY = e.pageY - this.offsetTop;      //                    angular.element(document).on('mousemove',function (e) {      //                        //鼠标距离浏览器的距离 - 鼠标距离元素边缘的距离 = 元素到浏览器的距离      //                        element.css({      //                            top:(e.pageY - disY)+'px',      //                            left:(e.pageX - disX)+'px',      //                        });      //                    });      //                    angular.element(document).on('mouseup',function () {      //                        angular.element(document).off(); //第一次执行后 移除所有document事件      //                    });      //                    e.preventDefault();//防止默认事件触发      //                });      //                /*element.on('click',function () {      //                 angular.element(this) == $(this)      //                    console.log(angular.element(this));      //                })*/      //            }      //        }      //    })      </script>      </body>      </html>      ##组件式 scope的取值 @ = &  - 组件优点：封装好的，可以多次调用         <div class=" container">            <div class="row">                <div class="col-md-12">                    <!--title="这是标题1" attrs props 想传递一些数据通过属性传递-->                    <panel title="这是标题1">这是内容一1</panel>                    <panel title="这是标题2">这是内容一2</panel>                    <panel title="这是标题3">这是内容一3</panel>                </div>            </div>        </div>        <!--        1 先要保留指令之间夹着的内容，指定放在哪个位置        2        -->        <script src="node_modules/angular/angular.js"></script>        <script>            var app=angular.module('appModule',[]);            app.run(['$rootScope',function ($rootScope) {                $rootScope.hello='你好'            }])            app.directive('panel',function () {                return {                    restrict:'E',                    //封装好了一个组件，可以多次调用                    templateUrl:'templ/penal.html',//通过路径引用html                    transclude:true,//保留内容嵌入到penal中                    /*link:function (scope,element,attr) {                        //想拿到attr中的属性放到heading中                        scope.title=attr.title;//将数据挂在作用域上，视图可以通过{{}}来获取值                    },*/        //            scope:true//{} 通过{}创建一个独立作用域                    scope:{                        title:'@title'//@取的是title对应的字符串 后面的名字相同可以去掉@title='输入值' <!--@引用的是字符串 是单向的-->                    },        //            scope:true//true 可以不断绝和外层关系，{}断绝和外层关系,默认不产生作用域，而且具有关系                }            })        </script>        </body>        </html>            =：    <body>    <input type="text" ng-model="title">    <panel tit="title"></panel>    <script src="node_modules/angular/angular.js"></script>    <script>        var app = angular.module('appModule',[]);        app.run(['$rootScope',function ($rootScope) {            $rootScope.title = 'zfpx'        }]);        //@符号取得是字符串  @符是单项的        //=号传递的是变量    =是双向的        app.directive('panel',function () {            return {                restrict:'E',                template:'<input ng-model="bb"/>',//通过路径 引用html                scope:{                    //属性的值发生变化 会重新给指令赋新的值                    bb:'=tit' //scope.bb =$rootScope.title =                }            }        })    </script>    </body>            &：    <body>    <input type="text" ng-model="title">    <panel ss="say(a,b)"></panel>    <script src="node_modules/angular/angular.js"></script>    <script>        //指令中拥有独立作用域，将方法通过属性传递到指令中 传递的时候需要用(属性="作用域上的方法()",指令中用&符号来接收        var app = angular.module('appModule',[]);        app.run(['$rootScope',function ($rootScope) {            $rootScope.say = function (who,where) {                alert(who);                alert(where)            }        }]);        app.directive('panel',function () {            return {                restrict:'E',                template:`<button ng-click="s({a:'你好',b:'不好'})">say</button>`,    //            template:'<button ng-click="s({a:\'你好\'})">say</button>',                scope:{                    s:'&ss'                }            }        })    </script>    </body>     ##指令和指令之间的交互     <girl cry eat>飞得更高梵蒂冈</girl>    <script src="node_modules/angular/angular.js"></script>    <script>        var app=angular.module('appModule',[]);        app.directive('girl',function () {            return {                //这个控制器代表就是指令的控制器                controller:function ($scope) {                    $scope.arr=[]//存放数据                    this.say=function (kinds) {                        $scope.arr.push(kinds)                    }                },                link:function (scope,element,attrs) {                    alert(scope,arr)                }            }        })        app.directive('cry',function () {            return {                require:'girl',//^ 代表找不到则向上找，如果找不到不想报错 ^?                link:function (scope,element,attrs,gCtrl) {//会将girl的controller 进行实例化，并且放在第四个参数上                    gCtrl.say('eat');//这里this就是实例 所以可以调用                    }            }        })        app.directive('eat',function () {            return {                require:'girl',                link:function (scope,element,attrs,gCtrl) {                    gCtrl.say('cry');                }            }        })        </script>    </body>        ##$watch 监听     <body ng-controller="myCtrl">     <input type="text" ng-model="name" ng-change="change()">     <span ng-bind="age"></span>     <script src="node_modules/angular/angular.js"></script>     <script>         var app=angular.module('appModule',[]);         app.controller('myCtrl',function ($scope) {             $scope.age=1;             //当输入的值为偶数的时候 age+1 如果超过10 就弹出提示框             $scope.$watch('age',function () {                  })             $scope.$watch(function () {//只要页面上有一个值变化，就会执行此函数，并且将函数的返回结果传入到另一个函数中                 return $scope.age                  },function (newval,oldval) {//$watch是$scope上的一个属性 监控作用域上的变量,还可以是函数                 if(newval>10){                     alert('大于10')                 }             })             $scope.change=function () {                if($scope.name%2==0){                    $scope.age++;                }             }         })          </script>     </body>     ###$apply       body ng-controller="myCtrl">     {{}}     <script src="node_modules/angular/angular.js"></script>     <script>         var app=angular.module('appModule',[]);         app.controller('myCtrl',function ($scope,$interval) {//$interval 提供的服务自动调用，都可以调用apply，不需要手动调用 watch + apply就实现了，双向数据绑定            var timer= $interval(function () {                $scope.data=Date.now()                 $interval.cancel(timer)   //取消定时器     //           $scope.$apply()//告诉angular数据有变化，刷新视图            },100)         })     </script> ##自定义      <body ng-controller="myCtrl">      <input type="text" zf-model="name">      {{name}}      <script src="node_modules/angular/angular.js"></script>      <script>          var app=angular.module('appModule',[]);          app.controller('myCtrl',function ($scope) {                })      //    1 ng-model 不会产生作用域       //    2 监控输入框中输入的值，将值赋值到作用域上  v->m      //    3 监控作用域上的值，将值赋给输入框 m->v          app.run(function ($rootScope) {              $rootScope.name='zfpx';          })          app.directive('zfModle',function () {              return {                 restrict:'A',                  link:function (scope,element,attrs) {                      element.on('input',function () {//监控输入框的输入事件  v->m                          scope[attrs.zfModle]=element.val();//[attrs.zfModle] 动态获取作用域上的值                          scope.apply()//强制让视图刷新  m->v                      })                      scope.$watch(attrs.zfModle,function (newval) {                          element.val(newval)                      })                  }              }          })     </script>     ##服务     <body>     <div ng-controller="oneCtrl"></div>     <div ng-controller="twoCtrl"></div>     <!--     1.angular中提供了五种服务 用的时候 我一般采用factory     provider,"factory",service,constant,value      provider 最大的服务     -->     <script src="node_modules/angular/angular.js"></script>     <script>         var app = angular.module('appModule',[]);         //1.放置在根作用域上         //1）默认provider会被实例化         //2）当我们在控制器中使用服务会调用他的$get方法         //1.provider是最大的服务，可以进行配置         app.config(function (CalcProvider) {             //CalcProvider 是Calc声明的函数的实例             CalcProvider.currency = 'RMB'; //会等provider创建好实例后进行配置             console.log(CalcProvider);         });         //1.new 函数 >  config  > $get方法         //localStorage         app.provider('Calc',function () {             this.currency = '$';             this.$get = function () {                 return { //用来公用的对象                     "+": (a,b)=>this.currency+(a+b)                 }             }         });//1.param1服务的名字   Calc代表的是$get函数的返回值         app.controller('oneCtrl',function ($scope,Calc) {             console.log(Calc["+"](1,2));         });         app.controller('twoCtrl',function ($scope,Calc) {             console.log(Calc["+"](4,6));         });     </script>    ##本地存储           <body>      <div ng-controller="oneCtrl"></div>      <div ng-controller="twoCtrl"></div>      <script src="node_modules/angular/angular.js"></script>      <script>          var app = angular.module('appModule',[]);          app.provider('Storage',function () {              this.$get = function () {                 return {                     setStorage:function (key,value) {                          if(typeof value =='object'){                              value = JSON.stringify(value);                          }                          localStorage.setItem(key,value);                     },                     getStorage:function(key){                         var str = localStorage.getItem(key);                         if(str.startsWith('{')||str.startsWith('[')){                             str = JSON.parse(str);                         }                         return str;                     }                 }              }          });          app.controller('oneCtrl',function ($scope,Storage) {              Storage.setStorage('name',{name:'jw'});      //      name:  {name:'zfpx'}              //cookie session localStorage sessionStorage              //localStorage.setItem('name',JSON.stringify({name:'zfpx'}));          });          app.controller('twoCtrl',function ($scope,Storage) {              console.log(Storage.getStorage('name').name)      //       age： {age:8}              //console.log(JSON.parse(localStorage.getItem('name')));          });      </script>           ##factory            var app = angular.module('appModule',[]);          //factory不支持配置 ，因为配置是在factory之前执行完成的,factory是基于provider的          app.factory('Calc', function () { //会先new provider              var currency = '$';              return {                  "+": (a,b)=>currency+(a+b)              }          }); //后面的函数就是$get函数          app.controller('oneCtrl',function ($scope,Calc) {              console.log(Calc["+"](1,2));          });          app.controller('twoCtrl',function ($scope,Calc) {              console.log(Calc["+"](4,6));          });      </script>       ##service     <body>     <div ng-controller="oneCtrl"></div>     <div ng-controller="twoCtrl"></div>     <script src="node_modules/angular/angular.js"></script>     <script>         var app = angular.module('appModule',[]);         app.service('Calc', function () {             this['+']=(a,b)=>a+b;             this["-"] = (a,b)=>a+b;         });         //factory返回的对象 是service函数实例化后的结果         /*return {          "+": (a,b)=>a+b,          "-":(a,b)=>a-b          }*/         app.controller('oneCtrl',function ($scope,Calc) {             //console.log(Calc["+"](1,2));         });         app.controller('twoCtrl',function ($scope,Calc) {            // console.log(Calc["+"](4,6));         });     </script>       ## value constant      <div ng-controller="oneCtrl"></div>      <div ng-controller="twoCtrl"></div>      <script src="node_modules/angular/angular.js"></script>      <script>          var app = angular.module('appModule',[]);          //调用的是factory          app.value('Calc', {              "+": (a,b)=>a+b,              "-":(a,b)=>a-b          });          app.controller('oneCtrl',function ($scope,Calc) {              console.log(Calc["+"](1,2));          });          app.controller('twoCtrl',function ($scope,Calc) {              console.log(Calc["+"](4,6));          });      </script>      ##平级 $on  $emit  $broadcast         <body>    <div ng-controller="parent">        <input type="text" ng-model="total">    </div>    <div ng-controller="child">        {{name}} <br>        {{price}} <br>        <input type="text" ng-model="count">    </div>    <!--通过总价算数量，通过数量还能算总价-->    <!--控制器 可以进行交互 $rootScope,服务,通过事件-->    <script src="node_modules/angular/angular.js"></script>    <script>        //交互方式 $on 监听 $emit 向上发射并且包括自己  $broadcast 向下发射并且包括自己        var app = angular.module('appModule',[]);        //发布订阅模式        app.controller('parent',function ($scope,$rootScope) {            //$scope.total = 10;            $rootScope.$on('爸爸我买了雪碧',function (e,data) {                $scope.total = data            });            $scope.$watch('total',function () {                $scope.$emit('给儿子200块',$scope.total);            });        });        app.controller('child',function ($scope,$rootScope) {            $scope.name = '雪碧';            $scope.price = 2.5;            $scope.count = 4;            $scope.$watch('count',function () {                //当数量变化的时候 向上发射                $scope.$emit('爸爸我买了雪碧',$scope.count*$scope.price);            });            $rootScope.$on('给儿子200块',function (e,data) {                $scope.count = data/$scope.price;            });        });    </script>    